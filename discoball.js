var e=null,h,j=this;j.requestAnimationFrame=j.requestAnimationFrame||j.webkitRequestAnimationFrame||j.mozRequestAnimationFrame||j.oRequestAnimationFrame||j.msRequestAnimationFrame||function(a){j.setTimeout(a,1E3/60)};function k(a,c){function d(){}d.prototype=c.prototype;a.la=c.prototype;a.prototype=new d}
function l(a,c,d){var f=c||j;if(arguments>2){var g=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(arguments,g);return a.apply(f,c)}}else return function(){return a.apply(f,arguments)}}function m(){throw Error("Unimplemented abstract method.");};function q(a,c){this.c=a||new u;this.d=typeof c==="undefined"?1:c}h=q.prototype;h.m=function(){return new q(this.c.m(),-this.d)};h.Q=function(){return Math.sqrt(this.r())};h.r=function(){return this.d*this.d+this.c.r()};h.t=function(){return this.k(this.Q())};h.L=function(){return new q(this.c.m(),this.d)};h.A=function(){return this.L().k(this.r())};h.f=function(a){if(typeof a==="number")return new q(this.c,this.d+a);else if(a instanceof q)return new q(this.c.f(a.c),this.d+a.d)};
h.l=function(a){if(typeof a==="number")return new q(this.c,this.d-a);else if(a instanceof q)return new q(this.c.l(a.c),this.d-a.d)};h.b=function(a){if(typeof a==="number")return new q(this.c.b(a),this.d*a);else if(a instanceof q)return new q(a.c.b(this.d).f(this.c.b(a.d)).f(this.c.N(a.c)),this.d*a.d-this.c.C(a.c))};h.k=function(a){if(typeof a==="number")return new q(this.c.k(a),this.d/a);else if(a instanceof q)return this.b(a.A())};h.transform=function(a){return this.b(a).b(this.A()).c};
h.toString=function(){return this.c+" + "+this.d};function u(a,c,d){this.d=0;this.c=this;this.x=a||0;this.y=c||0;this.a=d||0}k(u,q);var v=new u(1,0,0),z=new u(0,1,0),A=new u(0,0,1);h=u.prototype;h.m=function(){return new u(-this.x,-this.y,-this.a)};h.r=function(){return this.C(this)};h.f=function(a){return a instanceof u?new u(this.x+a.x,this.y+a.y,this.a+a.a):q.prototype.f.call(this,a)};h.l=function(a){return a instanceof u?new u(this.x-a.x,this.y-a.y,this.a-a.a):q.prototype.f.call(this,a)};
h.b=function(a){return typeof a==="number"?new u(this.x*a,this.y*a,this.a*a):q.prototype.b.call(this,a)};h.k=function(a){return typeof a==="number"?new u(this.x/a,this.y/a,this.a/a):q.prototype.k.call(this,a)};h.N=function(a){return new u(this.y*a.a-this.a*a.y,this.a*a.x-this.x*a.a,this.x*a.y-this.y*a.x)};h.C=function(a){return this.x*a.x+this.y*a.y+this.a*a.a};h.toString=function(){return this.x+"i + "+this.y+"j + "+this.a+"k"};function D(a,c){this.h=a||0;this.i=c||0}h=D.prototype;h.s=function(){return new D(this.h,-this.i)};h.f=function(a){return new D(this.h+a.h,this.i+a.i)};h.l=function(a){return new D(this.h-a.h,this.i-a.i)};h.m=function(){return new D(-this.h,-this.i)};h.b=function(a){return new D(this.h*a.h,this.h*a.i+this.i*a.h)};h.inverse=function(){return new D(1/this.h,-this.i/this.h/this.h)};h.k=function(a){return this.b(a.inverse())};h.sqrt=function(){return new D(Math.sqrt(this.h),this.i/2/Math.sqrt(this.h))};
h.toString=function(){return this.h+" + "+this.i+"e"};function E(a,c){this.c=a||new F;this.d=typeof c==="undefined"?new D(1):c}function G(a){return new E(new F(new D(0,a.x/2),new D(0,a.y/2),new D(0,a.a/2)),new D(1))}function H(a,c){var d=a.t().b(Math.sin(c/2));return new E(new F(new D(d.x),new D(d.y),new D(d.a)),new D(Math.cos(c/2)))}h=E.prototype;h.h=function(){return new q(this.c.h(),this.d.h)};h.i=function(){return new q(this.c.i(),this.d.i)};h.m=function(){return new E(this.c.m(),this.d.m())};h.Q=function(){return this.r().sqrt()};h.r=function(){return this.d.b(this.d).f(this.c.r())};
h.t=function(){return this.k(this.Q())};h.L=function(){return new E(this.c.m(),this.d)};h.s=function(){return new E(this.c.s(),this.d.s())};h.A=function(){return this.L().k(this.r())};h.f=function(a){if(a instanceof D)return new E(this.c,this.d.f(a));else if(a instanceof E)return new E(this.c.f(a.c),this.d.f(a.d))};h.l=function(a){if(a instanceof D)return new E(this.c,this.d.l(a));else if(a instanceof E)return new E(this.c.l(a.c),this.d.l(a.d))};
h.b=function(a){if(a instanceof D)return new E(this.c.b(a),this.d.b(a));else if(a instanceof E)return new E(a.c.b(this.d).f(this.c.b(a.d)).f(this.c.N(a.c)),this.d.b(a.d).l(this.c.C(a.c)));else if(a instanceof I){for(var c=new I,d=0;d<a.n.length;++d)c.set(d,this.b(a.n[d]));return c}};h.k=function(a){if(a instanceof D)return new E(this.c.k(a),this.d.k(a));else if(a instanceof E)return this.b(a.A())};h.transform=function(a){return this.b(new E(new F(new D(0,a.x),new D(0,a.y),new D(0,a.a)),new D(1))).b(this.s().A()).c.i()};
h.toString=function(){return this.c+" + "+this.d};function F(a,c,d){this.d=new D;this.c=this;this.x=a||new D;this.y=c||new D;this.a=d||new D}k(F,E);h=F.prototype;h.h=function(){return new u(this.x.h,this.y.h,this.a.h)};h.i=function(){return new u(this.x.i,this.y.i,this.a.i)};h.s=function(){return new F(this.x.s(),this.y.s(),this.a.s())};h.m=function(){return new F(this.x.m(),this.y.m(),this.a.m())};h.r=function(){return this.C(this)};h.f=function(a){return a instanceof F?new F(this.x.f(a.x),this.y.f(a.y),this.a.f(a.a)):E.prototype.f.call(this,a)};
h.l=function(a){return a instanceof F?new F(this.x.l(a.x),this.y.l(a.y),this.a.l(a.a)):E.prototype.f.call(this,a)};h.b=function(a){return a instanceof D?new F(this.x.b(a),this.y.b(a),this.a.b(a)):E.prototype.b.call(this,a)};h.k=function(a){return a instanceof D?new F(this.x.k(a),this.y.k(a),this.a.k(a)):E.prototype.k.call(this,a)};h.N=function(a){return new F(this.y.b(a.a).l(this.a.b(a.y)),this.a.b(a.x).l(this.x.b(a.a)),this.x.b(a.y).l(this.y.b(a.x)))};h.C=function(a){return this.x.b(a.x).f(this.y.b(a.y)).f(this.a.b(a.a))};
h.toString=function(){return"("+this.x+")i + ("+this.y+")j + ("+this.a+")k"};function aa(){this.I=10;this.o=128;this.j=[4,4,4];this.O=this.M=e}function J(a,c,d){return new u(a.I*Math.sin(c)*Math.sin(d),a.I*Math.cos(c),a.I*Math.sin(c)*Math.cos(d))};function K(a,c){this.ma=a;this.e=c;this.reset()}K.prototype.P=function(a,c){for(var d in a)this.w[d]=j.document.getElementById(d),this.w[d].width=window.innerWidth,this.w[d].height=window.innerHeight,this.z[d]=this.w[d].getContext("experimental-webgl",{antialias:!0}),this.J[d]=a[d],this.J[d].aa(this.z[d]);if(c)this.T=0,this.da=j.document.getElementById(c),this.Z=(new Date).getTime();this.ca()};K.prototype.round=function(a){return Math.round(10*a)/10};
K.prototype.ca=function(){for(var a in this.z){var c=window.innerWidth,d=window.innerHeight;if(this.ea[a]!==c||this.X[a]!==d)this.w[a].width=c,this.w[a].height=d,this.ea[a]=c,this.X[a]=d,this.J[a].$(this.z[a],c,d)}if(this.da)a=+new Date,this.T=0.25*(a-this.Z||1)+0.75*this.T,this.da.innerText=this.round(this.T)+" ms",this.Z=a;for(var f in this.z)this.J[f].ba(this.z[f]);this.e.update();j.setTimeout(l(this.ca,this),1E3/60)};
K.prototype.reset=function(){this.w={};this.z={};this.J={};this.ea={};this.X={}};function L(a,c){this.name=a.name+":"+c.name;this.F=a;this.D=c}var ba=/(.*)\[.*/;function M(a){var c=a.match(ba);return c?c[1]:a}L.prototype.create=function(a){this.F.create(a);this.D.create(a);this.handle=a.createProgram()};L.prototype.B=function(a){a.detachShader(this.handle,this.F.handle);this.F.B(a);a.detachShader(this.handle,this.D.handle);this.D.B(a);a.deleteProgram(this.handle);this.handle=e};
L.prototype.link=function(a){this.F.compile(a);a.attachShader(this.handle,this.F.handle);this.D.compile(a);a.attachShader(this.handle,this.D.handle);a.linkProgram(this.handle);if(!a.getProgramParameter(this.handle,a.LINK_STATUS)){var c=a.getProgramInfoLog(this.handle);this.B(a);throw Error(c);}for(var c=a.getProgramParameter(this.handle,a.ACTIVE_UNIFORMS),d=0;d<c;++d){var f=M(a.getActiveUniform(this.handle,d).name);this[f]=a.getUniformLocation(this.handle,f)}c=a.getProgramParameter(this.handle,a.ACTIVE_ATTRIBUTES);
for(d=0;d<c;++d)f=M(a.getActiveAttrib(this.handle,d).name),this[f]=a.getAttribLocation(this.handle,f)};function N(){}N.prototype.$=m;N.prototype.aa=m;N.prototype.ba=m;function O(a,c,d){this.name=a;this.ka=c;this.ja=d}O.prototype.create=function(a){this.handle=a.createShader(this.ka);a.shaderSource(this.handle,this.ja)};O.prototype.compile=function(a){a.compileShader(this.handle);if(!a.getShaderParameter(this.handle,a.COMPILE_STATUS)){var c=a.getShaderInfoLog(this.handle);this.B(a);throw Error(c);}};O.prototype.B=function(a){a.deleteShader(this.handle);this.handle=e};function R(a){this.W=a;this.e={};this.H={}}R.prototype.P=function(){this.W.onkeydown=l(this.fa,this);this.W.onkeyup=l(this.ga,this)};R.prototype.fa=function(a){return this.e[a.keyCode]=!0};R.prototype.ga=function(a){this.e[a.keyCode]=!1;return!0};R.prototype.update=function(){for(var a in this.e)this.H[a]=this.e[a]};function I(a){this.n=a||[]}h=I.prototype;h.inverse=function(){for(var a=new I,c=0;c<this.n.length;++c)a.set(c,this.n[c].A());return a};h.b=function(a){for(var c=new I,d=0;d<this.n.length;++d)c.set(d,this.n[d].b(a.n[d]));return c};h.set=function(a,c){this.n[a]=c};h.reset=function(){this.n=[]};h.get=function(){for(var a=[],c=0;c<this.n.length;++c){var d=this.n[c];a.push(d.c.x.h,d.c.y.h,d.c.a.h,d.d.h,d.c.x.i,d.c.y.i,d.c.a.i,d.d.i)}return a};window.onload=function(){var a=new R(document);(new K(window,a)).P({c0:new S(a)},"stats")};function S(a){this.e=a;this.G=this.p=e;this.S=!0}k(S,N);S.prototype.$=function(a,c,d){a.viewport(0,0,c,d);a=c/d;this.R=[0.2/(a/10- -a/10),0,0,0,0,1,0,0,(a/10+-a/10)/(a/10- -a/10),0,-300.1/299.9,-1,0,0,-60/299.9,0]};S.prototype.getShaderSource=function(a){return j.document.getElementById(a).text};function T(a,c){return[a+"px."+c,a+"nx."+c,a+"py."+c,a+"ny."+c,a+"pz."+c,a+"nz."+c]}
var U=[T("a","jpg"),T("b","png"),T("c","png"),T("d","jpg"),T("e","png"),T("f","png"),T("g","png"),T("h","png"),T("i","png"),T("j","png"),T("k","jpg"),T("l","png"),T("m","png"),T("n","jpg"),T("o","png"),T("p","jpg"),T("q","png"),T("r","png"),T("s","png"),T("u","png"),T("v","png")];
S.prototype.aa=function(a){this.e.P();var c=new O("v0",a.VERTEX_SHADER,this.getShaderSource("quatlib")+this.getShaderSource("v0")),d=new O("f0",a.FRAGMENT_SHADER,this.getShaderSource("f0"));this.p=new L(c,d);this.p.create(a);this.p.link(a);c=new O("v1",a.VERTEX_SHADER,this.getShaderSource("quatlib")+this.getShaderSource("v1"));d=new O("f1",a.FRAGMENT_SHADER,this.getShaderSource("f1"));this.u=new L(c,d);this.u.create(a);this.u.link(a);c=new O("v2",a.VERTEX_SHADER,this.getShaderSource("quatlib")+this.getShaderSource("v2"));
d=new O("f2",a.FRAGMENT_SHADER,this.getShaderSource("f2"));this.v=new L(c,d);this.v.create(a);this.v.link(a);a.enable(a.DEPTH_TEST);a.enable(a.CULL_FACE);this.G=a.createBuffer();this.Y=a.createBuffer();a.clearColor(0.1,0.1,0.1,1);this.g=G(new u(0,0,-15));this.K=new E;for(var c=new aa,d=2*Math.PI*c.I,f=d/c.o,g=[],s=c.M=0;s<c.o/2;++s){var t=Math.random(),B=s*2*Math.PI/c.o,x=(s+1)*2*Math.PI/c.o,w=(B+x)/2,y=0.0025/Math.sin(w),w=Math.floor(Math.sin(w)*d/f);c.M+=w;for(var C=0;C<w;++C){var r=C*2*Math.PI/
w,i=(C+1)*2*Math.PI/w,n=J(c,B+0.0025*Math.random(),r+y*Math.random()+t),p=J(c,B+0.0025*Math.random(),i-y*Math.random()+t),i=J(c,x-0.0025*Math.random(),i-y*Math.random()+t),r=J(c,x-0.0025*Math.random(),r+y*Math.random()+t),o=[n,p,i,r,n.f(p),p.f(i),i.f(r),r.f(n),n.f(p).f(i).f(r)][Math.floor(Math.random()*9)].t(),P=new u(0.15,0.15),Y=new u(0.15,0.85),Q=new u(0.85,0.85),Z=new u(0.85,0.15);g.push(n.x,n.y,n.a);g.push(o.x,o.y,o.a);g.push(c.j[0],c.j[1],c.j[2]);g.push(P.x,P.y);g.push(i.x,i.y,i.a);g.push(o.x,
o.y,o.a);g.push(c.j[0],c.j[1],c.j[2]);g.push(Q.x,Q.y);g.push(p.x,p.y,p.a);g.push(o.x,o.y,o.a);g.push(c.j[0],c.j[1],c.j[2]);g.push(Y.x,Y.y);g.push(n.x,n.y,n.a);g.push(o.x,o.y,o.a);g.push(c.j[0],c.j[1],c.j[2]);g.push(P.x,P.y);g.push(r.x,r.y,r.a);g.push(o.x,o.y,o.a);g.push(c.j[0],c.j[1],c.j[2]);g.push(Z.x,Z.y);g.push(i.x,i.y,i.a);g.push(o.x,o.y,o.a);g.push(c.j[0],c.j[1],c.j[2]);g.push(Q.x,Q.y)}}b=new Float32Array(g);this.V=c.M*6;a.bindBuffer(a.ARRAY_BUFFER,this.G);a.bufferData(a.ARRAY_BUFFER,b.byteLength,
a.STATIC_DRAW);a.bufferSubData(a.ARRAY_BUFFER,0,b);d=[];f=new u;for(g=c.O=0;g<c.o/2;++g){s=g*2*Math.PI/c.o;t=(g+1)*2*Math.PI/c.o;c.O+=c.o;for(B=0;B<c.o;++B)p=B*2*Math.PI/c.o,i=(B+1)*2*Math.PI/c.o,x=J(c,s,p).b(0.99),y=J(c,s,p).t(),w=J(c,s,i).b(0.99),C=J(c,s,i).t(),n=J(c,t,i).b(0.99),i=J(c,t,i).t(),r=J(c,t,p).b(0.99),p=J(c,t,p).t(),x.f(w).f(n).f(r).t(),d.push(x.x,x.y,x.a),d.push(y.x,y.y,y.a),d.push(f.x,f.y,f.a),d.push(0,0),d.push(n.x,n.y,n.a),d.push(i.x,i.y,i.a),d.push(f.x,f.y,f.a),d.push(0,0),d.push(w.x,
w.y,w.a),d.push(C.x,C.y,C.a),d.push(f.x,f.y,f.a),d.push(0,0),d.push(x.x,x.y,x.a),d.push(y.x,y.y,y.a),d.push(f.x,f.y,f.a),d.push(0,0),d.push(r.x,r.y,r.a),d.push(p.x,p.y,p.a),d.push(f.x,f.y,f.a),d.push(0,0),d.push(n.x,n.y,n.a),d.push(i.x,i.y,i.a),d.push(f.x,f.y,f.a),d.push(0,0)}b=new Float32Array(d);this.ha=c.O*6;a.bindBuffer(a.ARRAY_BUFFER,this.Y);a.bufferData(a.ARRAY_BUFFER,b.byteLength,a.STATIC_DRAW);a.bufferSubData(a.ARRAY_BUFFER,0,b);this.ia=a.createTexture();a.bindTexture(a.TEXTURE_2D,this.ia);
a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);c=document.createElement("img");c.onload=V(a,a.TEXTURE_2D,c,!0);c.src="light.png";this.q=0;W(this,a,this.q)};
function W(a,c,d){a.U&&c.deleteTexture(a.U);var d=U[d],f=c.createTexture();c.bindTexture(c.TEXTURE_CUBE_MAP,f);c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_MIN_FILTER,c.LINEAR);c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_MAG_FILTER,c.LINEAR);for(var g=[c.TEXTURE_CUBE_MAP_POSITIVE_X,c.TEXTURE_CUBE_MAP_NEGATIVE_X,c.TEXTURE_CUBE_MAP_POSITIVE_Y,c.TEXTURE_CUBE_MAP_NEGATIVE_Y,c.TEXTURE_CUBE_MAP_POSITIVE_Z,c.TEXTURE_CUBE_MAP_NEGATIVE_Z],s=0;s<6;++s){var t=document.createElement("img");t.onload=V(c,g[s],
t);t.src=d[s]}a.U=f}function V(a,c,d,f){return function(){a.texImage2D(c,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,d);f&&a.generateMipmap(c)}}
function X(a,c,d,f,g){a.bindBuffer(a.ARRAY_BUFFER,d);a.vertexAttribPointer(c.aPosition,3,a.FLOAT,!1,44,0);a.enableVertexAttribArray(c.aPosition);c.aNormal>=0&&(a.vertexAttribPointer(c.aNormal,3,a.FLOAT,!1,44,12),a.enableVertexAttribArray(c.aNormal));c.aColor>=0&&(a.vertexAttribPointer(c.aColor,3,a.FLOAT,!1,44,24),a.enableVertexAttribArray(c.aColor));c.aTexCoord>=0&&(a.vertexAttribPointer(c.aTexCoord,2,a.FLOAT,!1,44,36),a.enableVertexAttribArray(c.aTexCoord));a.drawArrays(g,0,f);a.disableVertexAttribArray(c.aPosition);
c.aNormal>=0&&a.disableVertexAttribArray(c.aNormal);c.aColor>=0&&a.disableVertexAttribArray(c.aColor);c.aTexCoord>=0&&a.disableVertexAttribArray(c.aTexCoord)}var ca=new u(40,0,20),$=Math.PI/64;
S.prototype.ba=function(a){if(this.S)this.K=this.K.b(H(z,$/16));if(this.e.e[74]&&!this.e.H[74])this.S=!this.S;if(this.e.e[78]&&!this.e.H[78]){++this.q;if(this.q>=U.length)this.q=0;W(this,a,this.q)}if(this.e.e[80]&&!this.e.H[80]){--this.q;if(this.q<0)this.q=U.length-1;W(this,a,this.q)}if(this.e.e[87])this.g=G(A.b(0.1)).b(this.g);if(this.e.e[83])this.g=G(A.b(-0.1)).b(this.g);if(this.e.e[65])this.g=G(v.b(0.1)).b(this.g);if(this.e.e[68])this.g=G(v.b(-0.1)).b(this.g);if(this.e.e[90])this.g=G(z.b(0.1)).b(this.g);
if(this.e.e[81])this.g=G(z.b(-0.1)).b(this.g);if(this.e.e[39])this.g=H(z,$).b(this.g);if(this.e.e[37])this.g=H(z,-$).b(this.g);if(this.e.e[40])this.g=H(v,$).b(this.g);if(this.e.e[38])this.g=H(v,-$).b(this.g);if(this.e.e[190])this.g=H(A,$).b(this.g);if(this.e.e[188])this.g=H(A,-$).b(this.g);a.clear(a.DEPTH_BUFFER_BIT|a.COLOR_BUFFER_BIT);a.useProgram(this.p.handle);a.cullFace(a.BACK);a.uniformMatrix4fv(this.p.uProjection,!1,this.R);a.uniform1i(this.p.uTexture,this.U);var c=(new I([this.g])).get();a.uniform4fv(this.p.uCamera,
c);c=(new I([this.g.b(this.K)])).get();a.uniform4fv(this.p.uTransform,c);var d=this.g.transform(ca);a.uniform3f(this.p.uLightPos,d.x,d.y,d.a);X(a,this.p,this.G,this.V,a.TRIANGLES);a.useProgram(this.v.handle);a.uniformMatrix4fv(this.v.uProjection,!1,this.R);a.uniform4fv(this.v.uTransform,c);a.uniform3f(this.v.uLightPos,d.x,d.y,d.a);X(a,this.v,this.Y,this.ha,a.TRIANGLES);a.useProgram(this.u.handle);a.cullFace(a.FRONT);a.uniformMatrix4fv(this.u.uProjection,!1,this.R);palette=(new I([this.g.b(this.K)])).get();
a.uniform4fv(this.u.uTransform,palette);c=this.g.transform(ca);a.uniform3f(this.u.uLightPos,c.x,c.y,c.a);X(a,this.u,this.G,this.V,a.TRIANGLES);a.flush()};
